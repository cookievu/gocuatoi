let contentTittleTags=[];$(document).ready(function(){contentTittleTags=document.body.querySelectorAll("article > h1, article > h2");const list=parseList();const sidebar=$('#content-sidebar');list.map(item=>{sidebar.append(`<li id="${item.id}"><a href="${item.href}">${item.title}</a></li>`);if(item.child&&item.child.length){const ul=document.createElement('ul');ul.id='ul-'+item.id;item.child.map(e=>ul.append(createListItem(e.id,e.href,e.title)));sidebar.append(ul);}});sidebarHandler();function parseList(){const list=[];let node=null;let latestTag=null;for(let i=0;i<contentTittleTags.length;i++){if(contentTittleTags[i].tagName==='H1'){node=createNote(i,contentTittleTags[i].id,contentTittleTags[i].textContent);}else{node.child.push(createNote(i,contentTittleTags[i].id,contentTittleTags[i].textContent));}
if(contentTittleTags[i].tagName==='H1'){list.push(node);}
latestTag=contentTittleTags[i].tagName;}
return list;}
function createNote(id,href,title){return{id:'node-'+id,href:'#'+href,title,child:[],};}
function createListItem(id,href,title){const childLi=document.createElement('li');const aTag=document.createElement('a');aTag.href=href;const text=document.createTextNode(title);aTag.append(text);childLi.append(aTag);childLi.id=id;return childLi;}
function sidebarHandler(){const observer=new IntersectionObserver(entries=>{entries.forEach((entry)=>{const index=getNodeListItemIndex(entry.target);if(index!==-1){const note=$('#node-'+index);if(entry.intersectionRatio>0){note.addClass('is-active');}else{note.removeClass('is-active');}}});});contentTittleTags.forEach(content=>observer.observe(content));}});function getNodeListItemIndex(item){const length=contentTittleTags.length;for(let i=0;i<length;i++){if(contentTittleTags[i].id===item.id){return i;}}
return-1;};$(document).ready(function(){const progressBar=document.querySelector('#reading-progress');if(progressBar){let lastScrollY=window.scrollY;let lastWindowHeight=window.innerHeight;let lastDocumentHeight=$(document).height();function onScroll(){lastScrollY=window.scrollY;update();}
function onResize(){lastWindowHeight=window.innerHeight;lastDocumentHeight=$(document).height();}
function update(){const progressMax=lastDocumentHeight-lastWindowHeight;progressBar.setAttribute('max',progressMax);progressBar.setAttribute('value',lastScrollY);}
window.addEventListener('scroll',onScroll,{passive:true});window.addEventListener('scroll',onResize);update();}});;window.onload=function(){const placeholders=document.querySelectorAll('.placeholder');const observer=new IntersectionObserver(entries=>{entries.forEach(entry=>{if(entry.intersectionRatio>0){loadImage(entry.target);observer.unobserve(entry.target);}});});placeholders.forEach(placeholder=>observer.observe(placeholder));};function loadImage(element){const smallImgElement=$(element).find('.img-small');const img=new Image();img.src=smallImgElement.attr('src');img.onload=function(){smallImgElement.addClass('loaded');};const imgLarge=new Image();imgLarge.src=$(element).data('large');imgLarge.onload=function(){imgLarge.classList.add('loaded');};$(element).append(imgLarge);}